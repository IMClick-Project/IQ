# MATLAB Apps and MATLAB Codes: Entropy

## 1. Isotherm given Temperature on a PS Diagram

The first option of the entropy menu allows generating on a PS diagram the isotherm of a substance given a temperature, a reference state, and a cubic equation of state ([documented code](https://github.com/IMClick-Project/IQ/blob/main/Cubic%20Equations%20of%20State%20Simulator/Code%20Documentation/Entropy%201%20-%20Isotherm%20given%20Temperature%20on%20a%20PS%20Diagram.md)). **Figure 1** illustrates the access mode and parts of the window for this option: **section a)** allows selecting the compound (which defines the corresponding reference state recorded in the database), the cubic equation of state, and the isotherm temperature to perform the calculations; and **section b)** graphs and shows the results of the computed isotherm on a PS diagram.

<img src="https://github.com/IMClick-Project/IQ/blob/main/Cubic%20Equations%20of%20State%20Simulator/MATLAB%20Grader/Assignment%202/Problem%204/s1-1.jpg" width="957" height="883">

*Figure 1. Mode of access to and parts of the window of the first option of the entropy menu: Isotherm given Temperature on a PS Diagram.*

**Figure 2** shows how to use this option. If there is no isotherm temperature available or the reference state is not completely defined, it is not possible to perform the calculations. If not, it performs the operations (for example, considering oxygen as the compound, van der Waals as the cubic equation of state, and 100 K as the isotherm temperature) and when it ends to graph and record the results, you can export the results in an Excel file (**Figure 3**).

<img src="https://github.com/IMClick-Project/IQ/blob/main/Cubic%20Equations%20of%20State%20Simulator/MATLAB%20Grader/Assignment%202/Problem%204/s1-2.jpg" width="780" height="1317">

*Figure 2. Mode of use and example of results executing the first option of the entropy menu: Isotherm given Temperature on a PS Diagram.*

<img src="https://github.com/IMClick-Project/IQ/blob/main/Cubic%20Equations%20of%20State%20Simulator/MATLAB%20Grader/Assignment%202/Problem%204/s1-3.jpg" width="445" height="500">

*Figure 3. Excel file with the exported results: Isotherm given Temperature on a PS Diagram.*

## 2. Two-Phase Envelope on a PS Diagram

The second option of the entropy menu allows generating on a PS diagram the saturated liquid and vapor line of a substance given the temperatures recorded in the simulator database, a reference state, and a cubic equation of state ([documented code](https://github.com/IMClick-Project/IQ/blob/main/Cubic%20Equations%20of%20State%20Simulator/Code%20Documentation/Entropy%202%20-%20Two-Phase%20Envelope%20on%20a%20PS%20Diagram.md)). **Figure 4** illustrates the access mode and parts of the window for this option: **section a)** allows selecting the compound (which defines the corresponding reference state recorded in the database) and the cubic equation of state to perform the calculations; and **section b)** graphs and shows the results of the computed saturated liquid and vapor line on a PS diagram, as well as the calculated critical point.

<img src="https://github.com/IMClick-Project/IQ/blob/main/Cubic%20Equations%20of%20State%20Simulator/MATLAB%20Grader/Assignment%202/Problem%204/s2-1.jpg" width="957" height="885">

*Figure 4. Mode of access to and parts of the window of the second option of the entropy menu: Two-Phase Envelope on a PS Diagram.*

**Figure 5** shows how to use this option. If there are no isotherm temperatures available in the simulator database or the reference state is not completely defined, it is not possible to perform the calculations. If not, it performs the operations (for example, considering refrigerant 134a as the compound and Redlich-Kwong as the cubic equation of state) and when it ends to graph and record the results, you can export the results in an Excel file (**Figure 6**).

<img src="https://github.com/IMClick-Project/IQ/blob/main/Cubic%20Equations%20of%20State%20Simulator/MATLAB%20Grader/Assignment%202/Problem%204/s2-2.jpg" width="746" height="1414">

*Figure 5. Mode of use and example of results executing the second option of the entropy menu: Two-Phase Envelope on a PS Diagram.*

<img src="https://github.com/IMClick-Project/IQ/blob/main/Cubic%20Equations%20of%20State%20Simulator/MATLAB%20Grader/Assignment%202/Problem%204/s2-3.jpg" width="681" height="457">

*Figure 6. Excel file with the exported results: Two-Phase Envelope on a PS Diagram.*

## 3. PST Surface given Isotherm Temperatures

The third option of the entropy menu allows generating on a PST surface the isotherms of a substance given the temperatures recorded in the simulator database, a reference state, and a cubic equation of state ([documented code](https://github.com/IMClick-Project/IQ/blob/main/Cubic%20Equations%20of%20State%20Simulator/Code%20Documentation/Entropy%203%20-%20PST%20Surface%20given%20Isotherm%20Temperatures.md)). **Figure 7** illustrates the access mode and parts of the window for this option: **section a)** allows selecting the compound (which defines the corresponding reference state recorded in the database) and the cubic equation of state to perform the calculations; and **section b)** graphs and shows the results of the computed isotherms on a PST surface.

<img src="https://github.com/IMClick-Project/IQ/blob/main/Cubic%20Equations%20of%20State%20Simulator/MATLAB%20Grader/Assignment%202/Problem%204/s3-1.jpg" width="957" height="857">

*Figure 7. Mode of access to and parts of the window of the third option of the entropy menu: PST Surface given Isotherm Temperatures.*

**Figure 8** shows how to use this option. If there are no isotherm temperatures available in the simulator database or the reference state is not completely defined, it is not possible to perform the calculations. If not, it performs the operations (for example, considering water as the compound and Peng-Robinson as the cubic equation of state).

<img src="https://github.com/IMClick-Project/IQ/blob/main/Cubic%20Equations%20of%20State%20Simulator/MATLAB%20Grader/Assignment%202/Problem%204/s3-2.jpg" width="811" height="1281">

*Figure 8. Mode of use and example of results executing the third option of the entropy menu: PST Surface given Isotherm Temperatures.*

## 4. Isobar given Pressure on a TS Diagram

The fourth option of the entropy menu allows generating on a TS diagram the isobar of a substance given a pressure, a reference state, and a cubic equation of state ([documented code](https://github.com/IMClick-Project/IQ/blob/main/Cubic%20Equations%20of%20State%20Simulator/Code%20Documentation/Entropy%204%20-%20Isobar%20given%20Pressure%20on%20a%20TS%20Diagram.md)). **Figure 9** illustrates the access mode and parts of the window for this option: **section a)** allows selecting the compound (which defines the corresponding reference state recorded in the database), the cubic equation of state, and the isobar pressure to perform the calculations; and **section b)** graphs and shows the results of the computed isobar on a TS diagram.

<img src="https://github.com/IMClick-Project/IQ/blob/main/Cubic%20Equations%20of%20State%20Simulator/MATLAB%20Grader/Assignment%202/Problem%204/s4-1.jpg" width="957" height="879">

*Figure 9. Mode of access to and parts of the window of the fourth option of the entropy menu: Isobar given Pressure on a TS Diagram.*

**Figure 10** shows how to use this option. If there is no isobar pressure available or the reference state is not completely defined, it is not possible to perform the calculations. If not, it performs the operations (for example, considering oxygen as the compound, van der Waals as the cubic equation of state, and 2.547 bar as the isobar pressure) and when it ends to graph and record the results, you can export the results in an Excel file (**Figure 11**).

<img src="https://github.com/IMClick-Project/IQ/blob/main/Cubic%20Equations%20of%20State%20Simulator/MATLAB%20Grader/Assignment%202/Problem%204/s4-2.jpg" width="768" height="1299">

*Figure 10. Mode of use and example of results executing the fourth option of the entropy menu: Isobar given Pressure on a TS Diagram.*

<img src="https://github.com/IMClick-Project/IQ/blob/main/Cubic%20Equations%20of%20State%20Simulator/MATLAB%20Grader/Assignment%202/Problem%204/s4-3.jpg" width="506" height="574">

*Figure 11. Excel file with the exported results: Isobar given Pressure on a TS Diagram.*

There is a thermodynamically impossible case that does not allow the prediction to be made through the Fugacity Test. This is when $\mathbf{P_{sat}}$ is not between the $\mathbf{P_{sat}}$ calculated from $\mathbf{T_t}$ and close to $\mathbf{T_c}$. **Figure 12** shows the results of this case in the simulator and exported to an Excel file.

<img src="https://github.com/IMClick-Project/IQ/blob/main/Cubic%20Equations%20of%20State%20Simulator/MATLAB%20Grader/Assignment%202/Problem%204/s4-4.jpg" width="769" height="1155">

*Figure 12. Results in the case not thermodynamically possible and the calculations of the Fugacity Test cannot be performed: Isobar given Pressure on a TS Diagram.*

## 5. Two-Phase Envelope on a TS Diagram

The fifth option of the entropy menu allows generating on a TS diagram the saturated liquid and vapor line of a substance given the pressures recorded in the simulator database, a reference state, and a cubic equation of state ([documented code](https://github.com/IMClick-Project/IQ/blob/main/Cubic%20Equations%20of%20State%20Simulator/Code%20Documentation/Entropy%205%20-%20Two-Phase%20Envelope%20on%20a%20TS%20Diagram.md)). **Figure 13** illustrates the access mode and parts of the window for this option: **section a)** allows selecting the compound (which defines the corresponding reference state recorded in the database) and the cubic equation of state to perform the calculations; and **section b)** graphs and shows the results of the computed saturated liquid and vapor line on a TS diagram, as well as the calculated critical point.

<img src="https://github.com/IMClick-Project/IQ/blob/main/Cubic%20Equations%20of%20State%20Simulator/MATLAB%20Grader/Assignment%202/Problem%204/s5-1.jpg" width="957" height="886">

*Figure 13. Mode of access to and parts of the window of the fifth option of the entropy menu: Two-Phase Envelope on a TS Diagram.*

**Figure 14** shows how to use this option. If there are no isobar pressures available in the simulator database or the reference state is not completely defined, it is not possible to perform the calculations. If not, it performs the operations (for example, considering refrigerant 134a as the compound and Soave-Redlich-Kwong as the cubic equation of state) and when it ends to graph and record the results, you can export the results in an Excel file (**Figure 15**).

<img src="https://github.com/IMClick-Project/IQ/blob/main/Cubic%20Equations%20of%20State%20Simulator/MATLAB%20Grader/Assignment%202/Problem%204/s5-2.jpg" width="751" height="1415">

*Figure 14. Mode of use and example of results executing the fifth option of the entropy menu: Two-Phase Envelope on a TS Diagram.*

<img src="https://github.com/IMClick-Project/IQ/blob/main/Cubic%20Equations%20of%20State%20Simulator/MATLAB%20Grader/Assignment%202/Problem%204/s5-3.jpg" width="702" height="454">

*Figure 15. Excel file with the exported results: Two-Phase Envelope on a TS Diagram.*

## 6. PST Surface given Isobar Pressures

The sixth option of the entropy menu allows generating on a PST surface the isobars of a substance given the pressures recorded in the simulator database, a reference state, and a cubic equation of state ([documented code](https://github.com/IMClick-Project/IQ/blob/main/Cubic%20Equations%20of%20State%20Simulator/Code%20Documentation/Entropy%206%20-%20PST%20Surface%20given%20Isobar%20Pressures.md)). **Figure 16** illustrates the access mode and parts of the window for this option: **section a)** allows selecting the compound (which defines the corresponding reference state recorded in the database) and the cubic equation of state to perform the calculations; and **section b)** graphs and shows the results of the computed isobars on a PST surface.

<img src="https://github.com/IMClick-Project/IQ/blob/main/Cubic%20Equations%20of%20State%20Simulator/MATLAB%20Grader/Assignment%202/Problem%204/s6-1.jpg" width="957" height="854">

*Figure 16. Mode of access to and parts of the window of the sixth option of the entropy menu: PST Surface given Isobar Pressures.*

**Figure 17** shows how to use this option. If there are no isobar pressures available in the simulator database or the reference state is not completely defined, it is not possible to perform the calculations. If not, it performs the operations (for example, considering water as the compound and Peng-Robinson as the cubic equation of state).

<img src="https://github.com/IMClick-Project/IQ/blob/main/Cubic%20Equations%20of%20State%20Simulator/MATLAB%20Grader/Assignment%202/Problem%204/s6-2.jpg" width="808" height="1281">

*Figure 17. Mode of use and example of results executing the sixth option of the entropy menu: PST Surface given Isobar Pressures.*

## 7. Exercises

Using the data provided for the ten compounds proposed in this course and the Fugacity Test results, answer the following questions:

+ Task_1: Check that methane at a pressure of 1.919 bar and entropy of 6 kJ/kg·K is in the saturated liquid-vapor mixture and calculate its quality. Use Redlich-Kwong as cubic equation of state.
+ Task_2: What is the pressure of hydrogen at a temperature of 25 K and entropy of 47.2908 kJ/kg·K, in bar? Use Soave-Redlich-Kwong as cubic equation of state.
+ Task_3: What is the temperature of argon at a pressure of 9.107 bar and entropy of 1.3897 kJ/kg·K, in K? Use Peng-Robinson as cubic equation of state.
+ Task_4: What is the entropy of saturated vapor oxygen at a pressure of 34.45 bar, in kJ/kg·K? Use van der Waals as cubic equation of state.
+ Task_5 (**Challenge** - Example 7-3 in Çengel et al., 2019 (**Figure 18**) - Use Peng-Robinson as cubic equation of state and pressure as a state property. Answer in kJ/K): A rigid tank contains 5 kg of refrigerant-134a initially at 20°C and 140 kPa. The refrigerant is now cooled while being stirred until its pressure drops to 100 kPa. Determine the entropy change of the refrigerant during this process.

<img src="https://github.com/IMClick-Project/IQ/blob/main/Cubic%20Equations%20of%20State%20Simulator/MATLAB%20Grader/Assignment%202/Problem%204/challenge.jpg" width="349" height="596">

*Figure 18. Example 7-3 in Çengel et al., 2019.*