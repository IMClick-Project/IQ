# MATLAB Apps and MATLAB Codes: Enthalpy

## 1. Isotherm given Temperature on a PH Diagram

The first option of the enthalpy menu allows generating on a PH diagram the isotherm of a substance given a temperature, a reference state, and a cubic equation of state ([documented code](https://github.com/IMClick-Project/IQ/blob/main/Cubic%20Equations%20of%20State%20Simulator/Code%20Documentation/Enthalpy%201%20-%20Isotherm%20given%20Temperature%20on%20a%20PH%20Diagram.md)). **Figure 1** illustrates the access mode and parts of the window for this option: **section a)** allows selecting the compound (which defines the corresponding reference state recorded in the database), the cubic equation of state, and the isotherm temperature to perform the calculations; and **section b)** graphs and shows the results of the computed isotherm on a PH diagram.

<img src="https://github.com/IMClick-Project/IQ/blob/main/Cubic%20Equations%20of%20State%20Simulator/MATLAB%20Grader/Assignment%202/Problem%203/h1-1.jpg" width="958" height="882">

*Figure 1. Mode of access to and parts of the window of the first option of the enthalpy menu: Isotherm given Temperature on a PH Diagram.*

**Figure 2** shows how to use this option. If there is no isotherm temperature available or the reference state is not completely defined, it is not possible to perform the calculations. If not, it performs the operations (for example, considering hydrogen as the compound, van der Waals as the cubic equation of state, and 24 K as the isotherm temperature) and when it ends to graph and record the results, you can export the results in an Excel file (**Figure 3**).

<img src="https://github.com/IMClick-Project/IQ/blob/main/Cubic%20Equations%20of%20State%20Simulator/MATLAB%20Grader/Assignment%202/Problem%203/h1-2.jpg" width="784" height="1319">

*Figure 2. Mode of use and example of results executing the first option of the enthalpy menu: Isotherm given Temperature on a PH Diagram.*

<img src="https://github.com/IMClick-Project/IQ/blob/main/Cubic%20Equations%20of%20State%20Simulator/MATLAB%20Grader/Assignment%202/Problem%203/h1-3.jpg" width="445" height="500">

*Figure 3. Excel file with the exported results: Isotherm given Temperature on a PH Diagram.*

## 2. Two-Phase Envelope on a PH Diagram

The second option of the enthalpy menu allows generating on a PH diagram the saturated liquid and vapor line of a substance given the temperatures recorded in the simulator database, a reference state, and a cubic equation of state ([documented code](https://github.com/IMClick-Project/IQ/blob/main/Cubic%20Equations%20of%20State%20Simulator/Code%20Documentation/Enthalpy%202%20-%20Two-Phase%20Envelope%20on%20a%20PH%20Diagram.md)). **Figure 4** illustrates the access mode and parts of the window for this option: **section a)** allows selecting the compound (which defines the corresponding reference state recorded in the database) and the cubic equation of state to perform the calculations; and **section b)** graphs and shows the results of the computed saturated liquid and vapor line on a PH diagram, as well as the calculated critical point.

<img src="https://github.com/IMClick-Project/IQ/blob/main/Cubic%20Equations%20of%20State%20Simulator/MATLAB%20Grader/Assignment%202/Problem%203/h2-1.jpg" width="958" height="886">

*Figure 4. Mode of access to and parts of the window of the second option of the enthalpy menu: Two-Phase Envelope on a PH Diagram.*

**Figure 5** shows how to use this option. If there are no isotherm temperatures available in the simulator database or the reference state is not completely defined, it is not possible to perform the calculations. If not, it performs the operations (for example, considering methane as the compound and Redlich-Kwong as the cubic equation of state) and when it ends to graph and record the results, you can export the results in an Excel file (**Figure 6**).

<img src="https://github.com/IMClick-Project/IQ/blob/main/Cubic%20Equations%20of%20State%20Simulator/MATLAB%20Grader/Assignment%202/Problem%203/h2-2.jpg" width="746" height="1414">

*Figure 5. Mode of use and example of results executing the second option of the enthalpy menu: Two-Phase Envelope on a PH Diagram.*

<img src="https://github.com/IMClick-Project/IQ/blob/main/Cubic%20Equations%20of%20State%20Simulator/MATLAB%20Grader/Assignment%202/Problem%203/h2-3.jpg" width="681" height="454">

*Figure 6. Excel file with the exported results: Two-Phase Envelope on a PH Diagram.*

## 3. PHT Surface given Isotherm Temperatures

The third option of the enthalpy menu allows generating on a PHT surface the isotherms of a substance given the temperatures recorded in the simulator database, a reference state, and a cubic equation of state ([documented code](https://github.com/IMClick-Project/IQ/blob/main/Cubic%20Equations%20of%20State%20Simulator/Code%20Documentation/Enthalpy%203%20-%20PHT%20Surface%20given%20Isotherm%20Temperatures.md)). **Figure 7** illustrates the access mode and parts of the window for this option: **section a)** allows selecting the compound (which defines the corresponding reference state recorded in the database) and the cubic equation of state to perform the calculations; and **section b)** graphs and shows the results of the computed isotherms on a PHT surface.

<img src="https://github.com/IMClick-Project/IQ/blob/main/Cubic%20Equations%20of%20State%20Simulator/MATLAB%20Grader/Assignment%202/Problem%203/h3-1.jpg" width="958" height="855">

*Figure 7. Mode of access to and parts of the window of the third option of the enthalpy menu: PHT Surface given Isotherm Temperatures.*

**Figure 8** shows how to use this option. If there are no isotherm temperatures available in the simulator database or the reference state is not completely defined, it is not possible to perform the calculations. If not, it performs the operations (for example, considering nitrogen as the compound and Peng-Robinson as the cubic equation of state).

<img src="https://github.com/IMClick-Project/IQ/blob/main/Cubic%20Equations%20of%20State%20Simulator/MATLAB%20Grader/Assignment%202/Problem%203/h3-2.jpg" width="808" height="1280">

*Figure 8. Mode of use and example of results executing the third option of the enthalpy menu: PHT Surface given Isotherm Temperatures.*

## 4. Isobar given Pressure on a TH Diagram

The fourth option of the enthalpy menu allows generating on a TH diagram the isobar of a substance given a pressure, a reference state, and a cubic equation of state ([documented code](https://github.com/IMClick-Project/IQ/blob/main/Cubic%20Equations%20of%20State%20Simulator/Code%20Documentation/Enthalpy%204%20-%20Isobar%20given%20Pressure%20on%20a%20TH%20Diagram.md)). **Figure 9** illustrates the access mode and parts of the window for this option: **section a)** allows selecting the compound (which defines the corresponding reference state recorded in the database), the cubic equation of state, and the isobar pressure to perform the calculations; and **section b)** graphs and shows the results of the computed isobar on a TH diagram.

<img src="https://github.com/IMClick-Project/IQ/blob/main/Cubic%20Equations%20of%20State%20Simulator/MATLAB%20Grader/Assignment%202/Problem%203/h4-1.jpg" width="958" height="880">

*Figure 9. Mode of access to and parts of the window of the fourth option of the enthalpy menu: Isobar given Pressure on a TH Diagram.*

**Figure 10** shows how to use this option. If there is no isobar pressure available or the reference state is not completely defined, it is not possible to perform the calculations. If not, it performs the operations (for example, considering hydrogen as the compound, van der Waals as the cubic equation of state, and 2.579 bar as the isobar pressure) and when it ends to graph and record the results, you can export the results in an Excel file (**Figure 11**).

<img src="https://github.com/IMClick-Project/IQ/blob/main/Cubic%20Equations%20of%20State%20Simulator/MATLAB%20Grader/Assignment%202/Problem%203/h4-2.jpg" width="772" height="1298">

*Figure 10. Mode of use and example of results executing the fourth option of the enthalpy menu: Isobar given Pressure on a TH Diagram.*

<img src="https://github.com/IMClick-Project/IQ/blob/main/Cubic%20Equations%20of%20State%20Simulator/MATLAB%20Grader/Assignment%202/Problem%203/h4-3.jpg" width="463" height="574">

*Figure 11. Excel file with the exported results: Isobar given Pressure on a TH Diagram.*

There is a thermodynamically impossible case that does not allow the prediction to be made through the Fugacity Test. This is when $\mathbf{P_{sat}}$ is not between the $\mathbf{P_{sat}}$ calculated from $\mathbf{T_t}$ and close to $\mathbf{T_c}$. **Figure 12** shows the results of this case in the simulator and exported to an Excel file.

<img src="https://github.com/IMClick-Project/IQ/blob/main/Cubic%20Equations%20of%20State%20Simulator/MATLAB%20Grader/Assignment%202/Problem%203/h4-4.jpg" width="770" height="1155">

*Figure 12. Results in the case not thermodynamically possible and the calculations of the Fugacity Test cannot be performed: Isobar given Pressure on a TH Diagram.*

## 5. Two-Phase Envelope on a TH Diagram

The fifth option of the enthalpy menu allows generating on a TH diagram the saturated liquid and vapor line of a substance given the pressures recorded in the simulator database, a reference state, and a cubic equation of state ([documented code](https://github.com/IMClick-Project/IQ/blob/main/Cubic%20Equations%20of%20State%20Simulator/Code%20Documentation/Enthalpy%205%20-%20Two-Phase%20Envelope%20on%20a%20TH%20Diagram.md)). **Figure 13** illustrates the access mode and parts of the window for this option: **section a)** allows selecting the compound (which defines the corresponding reference state recorded in the database) and the cubic equation of state to perform the calculations; and **section b)** graphs and shows the results of the computed saturated liquid and vapor line on a TH diagram, as well as the calculated critical point.

<img src="https://github.com/IMClick-Project/IQ/blob/main/Cubic%20Equations%20of%20State%20Simulator/MATLAB%20Grader/Assignment%202/Problem%203/h5-1.jpg" width="958" height="885">

*Figure 13. Mode of access to and parts of the window of the fifth option of the enthalpy menu: Two-Phase Envelope on a TH Diagram.*

**Figure 14** shows how to use this option. If there are no isobar pressures available in the simulator database or the reference state is not completely defined, it is not possible to perform the calculations. If not, it performs the operations (for example, considering methane as the compound and Soave-Redlich-Kwong as the cubic equation of state) and when it ends to graph and record the results, you can export the results in an Excel file (**Figure 15**).

<img src="https://github.com/IMClick-Project/IQ/blob/main/Cubic%20Equations%20of%20State%20Simulator/MATLAB%20Grader/Assignment%202/Problem%203/h5-2.jpg" width="751" height="1414">

*Figure 14. Mode of use and example of results executing the fifth option of the enthalpy menu: Two-Phase Envelope on a TH Diagram.*

<img src="https://github.com/IMClick-Project/IQ/blob/main/Cubic%20Equations%20of%20State%20Simulator/MATLAB%20Grader/Assignment%202/Problem%203/h5-3.jpg" width="702" height="454">

*Figure 15. Excel file with the exported results: Two-Phase Envelope on a TH Diagram.*

## 6. PHT Surface given Isobar Pressures

The sixth option of the enthalpy menu allows generating on a PHT surface the isobars of a substance given the pressures recorded in the simulator database, a reference state, and a cubic equation of state ([documented code](https://github.com/IMClick-Project/IQ/blob/main/Cubic%20Equations%20of%20State%20Simulator/Code%20Documentation/Enthalpy%206%20-%20PHT%20Surface%20given%20Isobar%20Pressures.md)). **Figure 16** illustrates the access mode and parts of the window for this option: **section a)** allows selecting the compound (which defines the corresponding reference state recorded in the database) and the cubic equation of state to perform the calculations; and **section b)** graphs and shows the results of the computed isobars on a PHT surface.

<img src="https://github.com/IMClick-Project/IQ/blob/main/Cubic%20Equations%20of%20State%20Simulator/MATLAB%20Grader/Assignment%202/Problem%203/h6-1.jpg" width="958" height="853">

*Figure 16. Mode of access to and parts of the window of the sixth option of the enthalpy menu: PHT Surface given Isobar Pressures.*

**Figure 17** shows how to use this option. If there are no isobar pressures available in the simulator database or the reference state is not completely defined, it is not possible to perform the calculations. If not, it performs the operations (for example, considering nitrogen as the compound and Peng-Robinson as the cubic equation of state).

<img src="https://github.com/IMClick-Project/IQ/blob/main/Cubic%20Equations%20of%20State%20Simulator/MATLAB%20Grader/Assignment%202/Problem%203/h6-2.jpg" width="807" height="1280">

*Figure 17. Mode of use and example of results executing the sixth option of the enthalpy menu: PHT Surface given Isobar Pressures.*

## 7. Exercises

Using the data provided for the ten compounds proposed in this course and the Fugacity Test results, answer the following questions:

+ Task_1: What is the temperature of ammonia at a pressure of 3.81 bar and enthalpy of 758.5853 kJ/kg, in K? Use Peng-Robinson as cubic equation of state.
+ Task_2: What is the enthalpy of chlorine at a saturation temperature of 373.15 K and quality of 0.84, in kJ/kg? Use Soave-Redlich-Kwong as cubic equation of state.
+ Task_3: What is the enthalpy of saturated liquid carbon dioxide at a temperature of 255 K, in kJ/kg? Use van der Waals as cubic equation of state.
+ Task_4: What is the pressure of nitrogen at a temperature of 120 K and enthalpy of -12.747 kJ/kg, in bar? Use Redlich-Kwong as cubic equation of state.
+ Task_5 (**Challenge** - Problem 5-48 in Çengel et al., 2019 (**Figure 18**) - Use Peng-Robinson as cubic equation of state and pressure as a state property. Answer in MW): Steam flows steadily through an adiabatic turbine. The inlet conditions of the steam are 4 MPa, 500°C, and 80 m/s, and the exit conditions are 30 kPa, 92 percent quality, and 50 m/s. The mass flow rate of the steam is 12 kg/s. Determine the power output.

<img src="https://github.com/IMClick-Project/IQ/blob/main/Cubic%20Equations%20of%20State%20Simulator/MATLAB%20Grader/Assignment%202/Problem%203/challenge.jpg" width="268" height="425">

*Figure 18. Problem 5-48 in Çengel et al., 2019*.